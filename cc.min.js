!function(factory){"use strict";"object"==typeof exports?module.exports=factory():"function"==typeof define&&define.amd?define(factory):window.CC=factory()}(function(){var elementMap={},elementsSize=0,canvas=document.getElementById("CascadeCanvas")||{},CC=function(selector){if(-1!=selector.indexOf("*")){var asArray=[];for(var e in elementMap)asArray.push(elementMap[e]);return new ElementList(asArray,selector)}var id,idArray=selector.match(/#[a-zA-Z0-9]*/);idArray&&(id=idArray[0]);var classes=selector.replace(/#[a-zA-Z0-9]*/,"").split(" "),selecteds=[];for(var i in elementMap){var e=elementMap[i];if(!id||id==e.id){var add=!0;for(var j in classes){var c=classes[j];if(c.length&&!e.classes[c]){add=!1;break}}add&&selecteds.push(e)}}return new ElementList(selecteds,selector)};CC.screen={x:0,y:0},CC.classes={},CC.context=canvas.getContext&&canvas.getContext("2d"),CC.step=0,CC.fn={},CC.new=function(specs,opts){var element=new Element(specs,opts);return elementMap[element.id?element.id:elementsSize++]=element,element},CC.def=function(classesStr,constructor){var classes=classesStr.split(" ");for(var i in classes){var c=classes[i];c.length&&(CC.classes[c]||(CC.classes[c]={constructors:[]}),CC.classes[c].constructors.push(constructor))}},CC.clear=function(){CC.classes={},elementMap={},elementsSize=0,CC.clearEvents()},CC.___remove=function(el){el.trigger("remove");for(var i in elementMap)elementMap[i]==el&&delete elementMap[i]},canvas.onselectstart=function(){return!1};var eventEnvironmentBuilder=function(owner){var events=[];owner.bind=function(eventsStr,action){var evtAndNamespace=eventsStr.split("."),evtName=evtAndNamespace[0],namespace=evtAndNamespace[1]||"root";return evtName&&evtName.length?(events[evtName]||(events[evtName]={}),events[evtName][namespace]||(events[evtName][namespace]=[]),action&&events[evtName][namespace].push(action),{unbind:function(){owner.unbind(eventsStr,action)}}):void 0},owner.unbind=function(eventsStr,action){var evtAndNamespace=eventsStr.split("."),evtName=evtAndNamespace[0],namespace=evtAndNamespace[1]||"root";if(evtName&&evtName.length)if("root"!=namespace)if(action){if(events[evtName]&&events[evtName][namespace])for(var i in events[evtName][namespace])events[evtName][namespace][i]===action&&events[evtName][namespace].splice(i,1)}else events[evtName]&&delete events[evtName][namespace];else if(action)for(var i in events[evtName])for(var j in events[evtName][i])events[evtName][i][j]===action&&events[evtName][i].splice(j,1);else delete events[evtName];else if("root"!=namespace)if(action)for(var i in events)for(var j in events[i][namespace])events[i][namespace][j]===action&&events[i][namespace].splice(j,1);else for(var i in events)delete events[i][namespace]},owner.trigger=function(eventsStr){if(running){var evtAndNamespace=eventsStr.split("."),evtName=evtAndNamespace[0],namespace=evtAndNamespace[1]||"root",args=[].splice.call(arguments,1),callNamespace=function(n){var e=events[evtName][n];for(var i in e)e[i].apply(owner,args)};if(events[evtName])if("root"==namespace)for(var d in events[evtName])callNamespace(d);else events[evtName]&&events[evtName][namespace]&&callNamespace(namespace)}},owner.clearEvents=function(){events=[]}};eventEnvironmentBuilder(CC),CC.isFunction=function(functionToCheck){return null!=functionToCheck&&"[object Function]"==={}.toString.call(functionToCheck)},CC.isString=function(stringToCheck){return"string"==typeof stringToCheck||stringToCheck instanceof String},CC.isArray=function(arrayToCheck){return null!=arrayToCheck&&"[object Array]"==={}.toString.call(arrayToCheck)},CC.isObject=function(objectToCheck){return null!=objectToCheck&&"object"==typeof objectToCheck&&!CC.isFunction(objectToCheck)&&!CC.isString(objectToCheck)&&!CC.isArray(objectToCheck)},CC.merge=function(){for(var mergeRecursively=function(merged,obj){if(merged&&obj)for(var p in obj)CC.isObject(obj[p])?(merged[p]&&CC.isObject(merged[p])||(merged[p]={}),mergeRecursively(merged[p],obj[p])):merged[p]=obj[p]},i=1;i<arguments.length;i++)mergeRecursively(arguments[0],arguments[i]);return arguments[0]},CC.sort=function(elements,prop,invert){if(!CC.isArray(elements)){var asArray=[];for(var e in elements)asArray.push(elements[e]);elements=asArray}return elements.sort(function(a,b){if(a[prop]>b[prop])return invert?-1:1;if(a[prop]<b[prop])return invert?1:-1;if(void 0==a[prop]){if(b[prop]<0)return invert?-1:1;if(b[prop]>0)return invert?1:-1}if(void 0==b[prop]){if(a[prop]<0)return invert?1:-1;if(a[prop]>0)return invert?-1:1}return 0})},CC.rotatePoint=function(p,anchor,angle){var px=p.x;void 0==px&&p.length>1&&(px=p[0]);var py=p.y;void 0==py&&p.length>1&&(py=p[1]);var ax=anchor.x;void 0==ax&&anchor.length>1&&(ax=anchor[0]);var ay=anchor.y;void 0==ay&&anchor.length>1&&(ay=anchor[1]);var teta=angle*Math.PI/-180,diffX=px-ax,diffY=py-ay,cos=Math.cos(teta),sin=Math.sin(teta);return{x:Math.round(cos*diffX-sin*diffY+ax),y:Math.round(sin*diffX+cos*diffY+ay)}},CC.Promise=function(){this._callbacks=[]},CC.Promise.prototype.then=function(func,context){var p;return this._isdone?p=func.apply(context,this.result):(p=new CC.Promise,this._callbacks.push(function(){var res=func.apply(context,arguments);res&&CC.isFunction(res.then)&&res.then(p.done,p)})),p},CC.Promise.prototype.done=function(){this.result=arguments,this._isdone=!0;for(var i=0;i<this._callbacks.length;i++)this._callbacks[i].apply(null,arguments);this._callbacks=[]},CC.when=function(eventsStr){var p=new CC.Promise,cb=function(){p.done.apply(p,arguments),CC.unbind(eventsStr,cb)};return CC.bind(eventsStr,cb),p},CC.promiseJoin=function(promises){for(var p=new CC.Promise,total=promises.length,numdone=0,results=[],notifier=function(i){return function(){numdone+=1,results[i]=Array.prototype.slice.call(arguments),numdone===total&&p.done.apply(p,results)}},i=0;total>i;i++)promises[i].then(notifier(i));return p},CC.promiseChain=function(funcs,args){var p=new CC.Promise;if(0===funcs.length)p.done.apply(p,args);else{var pi=funcs[0].apply(null,args);pi&&CC.isFunction(pi.then)&&pi.then(function(){funcs.splice(0,1),CC.promiseChain(funcs,arguments).then(function(){p.done.apply(p,arguments)})})}return p},canvas.onclick=function(event){CC.trigger("click",event)},canvas.oncontextmenu=function(event){return CC.trigger("rightclick",event),!1};var keyPressed={},keyMapping={8:"BACKSPACE",13:"ENTER",16:"SHIFT",17:"CTRL",18:"ALT",20:"CAPSLOCK",27:"ESC",33:"PGUP",34:"PGDOWN",35:"END",36:"HOME",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",44:"PRINTSCREEN",45:"INSERT",46:"DEL",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"WIN",93:"RIGHTCMD",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12"},keyAlias={CMD:"WIN",OPTION:"ALT"};window.addEventListener("keyup",function(event){delete keyPressed[keyMapping[event.keyCode]],CC.trigger("keyup",event)},!1),window.addEventListener("keydown",function(event){keyPressed[keyMapping[event.keyCode]]=!0,CC.trigger("keydown",event)},!1),CC.isNoKeyPressed=function(){for(var j in keyPressed)return!1;return!0},CC.isKeysPressed=function(keys){var keysArr=keys.toUpperCase().replace(/ /g,"").split("+");for(var i in keysArr)if(keyAlias[i]&&(i=keyAlias[i]),!keyPressed[keysArr[i]])return!1;return!0},CC.isKeysPressedOnly=function(keys){var keysArr=keys.toUpperCase().replace(/ /g,"").split("+"),map={};for(var i in keysArr){keyAlias[i]&&(i=keyAlias[i]);var key=keysArr[i];if(!keyPressed[key])return!1;map[key]=!0}for(var j in keyPressed)if(!map[j])return!1;return!0},CC.onKeysDown=function(keys,action){return CC.bind("keydown",function(event){CC.isKeysPressed(keys)&&action(event)})},CC.onKeysDownOnly=function(keys,action){return CC.bind("keydown",function(event){CC.isKeysPressedOnly(keys)&&action(event)})},CC.onKeysUpOnly=function(keys,action){return CC.bind("keyup",function(event){var wantedArr=keys.toUpperCase().replace(/ /g,"").split("+"),wantedMap={};for(var i in wantedArr){keyAlias[i]&&(i=keyAlias[i]);var wanted=wantedArr[i];if(!keyPressed[wanted]&&wanted!=keyMapping[event.keyCode])return;wantedMap[wanted]=!0}if(wantedMap[keyMapping[event.keyCode]]){for(var j in keyPressed)if(!wantedMap[j])return;action(event)}})},CC.onKeysSequence=function(keys,maxdelay,action){var step=0,wantedKeys=[];for(var i in keys){var k=keys[i].toUpperCase();keyAlias[k]&&(k=keyAlias[k]),wantedKeys.push(k)}var timeout;CC.bind("keydown",function(event){clearTimeout(timeout),wantedKeys[step]===keyMapping[event.keyCode]?step++:step=0,step==wantedKeys.length&&(step=0,action()),timeout=setTimeout(function(){step=0},maxdelay)})},CC.ajaxTimeout=0;var _encode=function(data){var result="";if("string"==typeof data)result=data;else{var e=encodeURIComponent;for(var k in data)data.hasOwnProperty(k)&&(result+="&"+e(k)+"="+e(data[k]))}return result},new_xhr=function(){var xhr;if(window.XMLHttpRequest)xhr=new XMLHttpRequest;else if(window.ActiveXObject)try{xhr=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){xhr=new ActiveXObject("Microsoft.XMLHTTP")}return xhr};CC.ajax=function(method,url,data,headers){var xhr,payload,p=new CC.Promise;data=data||{},headers=headers||{};try{xhr=new_xhr()}catch(e){return p.done(!1,"no xhr"),p}payload=_encode(data),"GET"===method&&payload&&(url+="?"+payload,payload=null),xhr.open(method,url),xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");for(var h in headers)headers.hasOwnProperty(h)&&xhr.setRequestHeader(h,headers[h]);var onTimeout=function(){xhr.abort(),p.done(!1,"timeout",xhr)},timeout=CC.ajaxTimeout;if(timeout)var tid=setTimeout(onTimeout,timeout);return xhr.onreadystatechange=function(){if(timeout&&clearTimeout(tid),4===xhr.readyState){var success=xhr.status&&(xhr.status>=200&&xhr.status<300||304===xhr.status);p.done(success,xhr.responseText,xhr)}},xhr.send(payload),p};var sprites={};CC.loadResources=function(srcs,callback){var loadRecursively=function(index){var img=new Image;img.src=srcs[index],img.onload=function(){sprites[srcs[index]]=this,index<srcs.length-1?loadRecursively(index+1):callback()}};loadRecursively(0)},CC.useResource=function(src){return sprites[src]};var requestAnimId,intervalAnimId,running=!0;CC.startLoop=function(){var mainloop=function(){running&&(CC.screen.w=canvas.offsetWidth,CC.screen.h=canvas.offsetHeight,CC.trigger("enterframe"),draw(),CC.step++)},animFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null;if(null!==animFrame){var recursiveAnim=function(){mainloop(),requestAnimId=animFrame(recursiveAnim)};requestAnimId=animFrame(recursiveAnim)}else{var ONE_FRAME_TIME=1e3/60;intervalAnimId=setInterval(mainloop,ONE_FRAME_TIME)}},CC.stopLoop=function(){if(requestAnimId){var cancelFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||null;null!==cancelFrame&&(cancelFrame(requestAnimId),requestAnimId=null)}intervalAnimId&&(clearInterval(intervalAnimId),intervalAnimId=null)},CC.pause=function(){running=!1},CC.play=function(){running=!0};var draw=function(){CC.context.clearRect(0,0,CC.screen.w,CC.screen.h),CC("*").sort("zIndex",!0).each(function(){this.draw()})};CC.setScreenCenter=function(x,y){CC.screen.x=CC.screen.w/2-x,CC.screen.y=CC.screen.h/2-y};var Element=function(specs,opts){var el=this,removed=!1;this.classes={},this.layers={};var init=function(){var idArray=specs.match(/#[a-zA-Z0-9]*/);idArray&&(el.id=idArray[0]),opts&&(el.x=opts.x,el.y=opts.y,el.w=opts.w,el.h=opts.h,el.angle=opts.angle,el.anchor=opts.anchor,el.flip=opts.flip,el.hidden=opts.hidden,el.zIndex=opts.zIndex),eventEnvironmentBuilder(el),el.inherit(specs.replace(/#[a-zA-Z0-9]*/g,""),opts)};this.inherit=function(classesStr,opts){if(removed)return this;var classes=classesStr.split(" ");for(var i in classes){var s=classes[i];if(s.length&&!this.classes[s])if(this.classes[s]=CC.classes[s],CC.classes[s]&&CC.classes[s].constructors)for(var j in CC.classes[s].constructors){var c=CC.classes[s].constructors[j];c.call(this,opts)}else this.classes[s]={constructors:[]}}return this},this.matches=function(specs){var matchesRecursively=function(a,b){if(!a||!b)return!1;for(var i in b){if(void 0===a[i])return!1;if(CC.isObject(b[i])){if(matchesRecursively(a[i],b[i])===!1)return!1}else if(!CC.isString(b[i])||0!=b[i].indexOf("<")&&0!=b[i].indexOf(">")&&0!=b[i].indexOf("!=")){if(a[i]!==b[i])return!1}else{if(0==b[i].indexOf("<=")&&a[i]>b[i].replace("<=",""))return!1;if(0==b[i].indexOf("<")&&a[i]>=b[i].replace("<",""))return!1;if(0==b[i].indexOf(">=")&&a[i]<b[i].replace(">=",""))return!1;if(0==b[i].indexOf(">")&&a[i]<=b[i].replace(">",""))return!1;if(0==b[i].indexOf("!=")&&a[i]==b[i].replace("!=",""))return!1}}return!0};return matchesRecursively(this,specs)},this.merge=function(){if(!removed){var args=[].splice.call(arguments,0);return args.splice(0,0,this),CC.merge.apply(CC,args),this}},this.remove=function(){removed||(removed=!0,CC.___remove(this))},this.removeClass=function(classe){void 0!==this.classes[classe]&&(this.trigger("removeClass."+classe),this.unbind("."+classe),delete this.classes[classe])},this.became=function(specs,action){var matched=!1;return CC.bind("enterframe",function(){var newmatched=el.matches(specs);!matched&&newmatched&&action.call(el),matched=newmatched})},this.while=function(specs,action){return CC.bind("enterframe",function(){el.matches(specs)&&action.call(el)})},this.onClick=function(action){return CC.bind("click",function(event){var x=event.offsetX,y=event.offsetY;x>=el.x&&x<=el.x+el.w&&y>=el.y&&y<=el.y+el.h&&action.call(el)})},this.hideAllLayers=function(){for(var i in this.layers)this.layers[i].hidden=!0},this.toggleLayers=function(toHide,toShow){this.layers[toHide].hidden=!0,this.layers[toShow].hidden=!1},this.draw=function(){if(this.hidden!==!0){var layers=CC.sort(this.layers,"zIndex",!0);for(var s in layers){var layr=layers[s];CC.isFunction(layr)?layr.call(this):drawLayer(layr)}}};var drawLayer=function(layr){if(layr&&layr.hidden!==!0){var EW=el.w,EH=el.h;if(CC.isArray(layr.shape)&&(!el.w||!el.h)){EW=el.w||0,EH=el.h||0;for(var i in layr.shape)EW=Math.max(EW,layr.shape[i][0]),EH=Math.max(EH,layr.shape[i][1])}var offsetX=layr.offsetX||0,offsetY=layr.offsetY||0,FW=layr.w||EW,FH=layr.h||EH,normalSX=-1*CC.screen.x,normalSY=-1*CC.screen.y;if(!(el.x+offsetX+FW<normalSX||el.x+offsetX-FW>normalSX+CC.screen.w||el.y+offsetY+FH<normalSY||el.y+offsetY-FH>normalSY+CC.screen.h)){if(CC.context.save(),CC.context.translate(CC.screen.x,CC.screen.y),CC.context.translate(el.x,el.y),el.angle&&(el.anchor||(el.anchor={x:EW/2,y:EH/2}),CC.context.translate(el.anchor.x,el.anchor.y),CC.context.rotate(el.angle*Math.PI/-180),CC.context.translate(-el.anchor.x,-el.anchor.y)),layr.angle&&(layr.anchor||(layr.anchor=el.anchor||{x:EW/2,y:EH/2}),CC.context.translate(layr.anchor.x,layr.anchor.y),CC.context.rotate(layr.angle*Math.PI/-180),CC.context.translate(-layr.anchor.x,-layr.anchor.y)),CC.context.translate(offsetX-(FW-EW)/2,offsetY-(FH-EH)/2),el.flip&&el.flip.length){var scaleHor=-1!=el.flip.indexOf("x")?-1:1,scaleVer=-1!=el.flip.indexOf("y")?-1:1;CC.context.translate(FW/2,FH/2),CC.context.scale(scaleHor,scaleVer),CC.context.translate(-FW/2,-FH/2)}if(layr.flip&&layr.flip.length){var scaleHor=-1!=layr.flip.indexOf("x")?-1:1,scaleVer=-1!=layr.flip.indexOf("y")?-1:1;CC.context.translate(FW/2,FH/2),CC.context.scale(scaleHor,scaleVer),CC.context.translate(-FW/2,-FH/2)}if(layr.scale&&(layr.scale.x||layr.scale.y)&&(CC.context.translate(FW/2,FH/2),CC.context.scale(layr.scale.x||1,layr.scale.y||1),CC.context.translate(-FW/2,-FH/2)),layr.fill)if(layr.fill.color&&CC.isString(layr.fill.color)?CC.context.fillStyle=layr.fill.color:layr.fill.linearGradient?CC.context.fillStyle=createLinearGradient(layr.fill.linearGradient,FW,FH):layr.fill.radialGradient&&(CC.context.fillStyle=createRadialGradient(layr.fill.radialGradient,FW,FH)),"rect"===layr.shape||void 0===layr.shape)layr.roundedBorderRadius?(createRoundedBorder(FW,FH,layr.roundedBorderRadius),CC.context.fill()):CC.context.fillRect(0,0,FW,FH);else if("circle"===layr.shape)CC.context.beginPath(),CC.context.arc((W+offsetW)/2,(W+offsetW)/2,(W+offsetW)/2,0,2*Math.PI),CC.context.closePath(),CC.context.fill();else if(CC.isArray(layr.shape)){CC.context.beginPath(),CC.context.moveTo(layr.shape[0][0],layr.shape[0][1]);for(var p in layr.shape){var point=layr.shape[p];CC.context.lineTo(point[0],point[1])}CC.context.closePath(),CC.context.fill()}if(layr.stroke)if(layr.stroke.color&&CC.isString(layr.stroke.color)?CC.context.strokeStyle=layr.stroke.color:layr.stroke.linearGradient?CC.context.strokeStyle=createLinearGradient(layr.stroke.linearGradient,FW,FH):layr.fill.radialGradient&&(CC.context.strokeStyle=createRadialGradient(layr.stroke.radialGradient,FW,FH)),layr.stroke.thickness&&(CC.context.lineWidth=layr.stroke.thickness),layr.stroke.cap&&(CC.context.lineCap=layr.stroke.cap),layr.stroke.join&&(CC.context.lineJoin=layr.stroke.join),"rect"===layr.shape||void 0===layr.shape)layr.roundedBorderRadius?(createRoundedBorder(FW,FH,layr.roundedBorderRadius),CC.context.stroke()):CC.context.strokeRect(0,0,FW,FH);else if("circle"===layr.shape)CC.context.beginPath(),CC.context.arc(FW/2,FW/2,FW/2,0,2*Math.PI),CC.context.closePath(),CC.context.stroke();else if(CC.isArray(layr.shape)){CC.context.beginPath(),CC.context.moveTo(layr.shape[0][0],layr.shape[0][1]);for(var p in layr.shape){var point=layr.shape[p];CC.context.lineTo(point[0],point[1])}CC.context.closePath(),CC.context.stroke()}if(layr.sprite&&layr.sprite.url){if("rect"===layr.shape||void 0===layr.shape)layr.roundedBorderRadius?createRoundedBorder(FW,FH,layr.roundedBorderRadius):(CC.context.beginPath(),CC.context.moveTo(0,0),CC.context.lineTo(FW,0),CC.context.lineTo(FW,FH),CC.context.lineTo(0,FH),CC.context.closePath()),CC.context.clip();else if("circle"===layr.shape)CC.context.beginPath(),CC.context.arc(FW/2,FW/2,FW/2,0,2*Math.PI),CC.context.closePath(),CC.context.clip();else if(CC.isArray(layr.shape)){CC.context.beginPath(),CC.context.moveTo(layr.shape[0][0],layr.shape[0][1]);for(var p in layr.shape){var point=layr.shape[p];CC.context.lineTo(point[0],point[1])}CC.context.closePath(),CC.context.clip()}var res=CC.useResource(layr.sprite.url),spriteX=layr.sprite.x||0,spriteY=layr.sprite.y||0,spriteW=layr.sprite.w||Math.min(FW,res.width),spriteH=layr.sprite.h||Math.min(FH,res.height),startX=0,startY=0,repeatX=layr.sprite.repeat&&-1!=layr.sprite.repeat.indexOf("x"),repeatY=layr.sprite.repeat&&-1!=layr.sprite.repeat.indexOf("y"),delay=layr.sprite.delay||0;layr.sprite.frames&&(layr.sprite.vertical?spriteY+=parseInt(CC.step/delay)%layr.sprite.frames*spriteH:spriteX+=parseInt(CC.step/delay)%layr.sprite.frames*spriteW);do{startY=0;do CC.context.drawImage(res,spriteX,spriteY,spriteW,spriteH,startX,startY,spriteW,spriteH),repeatY&&(startY+=spriteH);while(EH>startY&&repeatY);repeatX&&(startX+=spriteW)}while(EW>startX&&repeatX)}CC.context.restore()}}},createLinearGradient=function(linearGradient,FW,FH){linearGradient.start||(linearGradient.start=[0,0]),linearGradient.end||(linearGradient.end=[100,0]);var x1=linearGradient.start[0]/100*FW,y1=linearGradient.start[1]/100*FH,x2=linearGradient.end[0]/100*FW,y2=linearGradient.end[1]/100*FH,gradient=CC.context.createLinearGradient(x1,y1,x2,y2);for(var s in linearGradient){var stop=parseFloat(s);!isNaN(stop)&&isFinite(stop)&&gradient.addColorStop(stop,linearGradient[s])}return gradient},createRadialGradient=function(radialGradient,FW,FH){radialGradient.innerCircle||(radialGradient.innerCircle={}),void 0===radialGradient.innerCircle.centerX&&(radialGradient.innerCircle.centerX=50),void 0===radialGradient.innerCircle.centerY&&(radialGradient.innerCircle.centerY=50),void 0===radialGradient.innerCircle.radius&&(radialGradient.innerCircle.radius=0),radialGradient.outerCircle||(radialGradient.outerCircle={}),void 0===radialGradient.outerCircle.centerX&&(radialGradient.outerCircle.centerX=50),void 0===radialGradient.outerCircle.centerY&&(radialGradient.outerCircle.centerY=50),void 0===radialGradient.outerCircle.radius&&(radialGradient.outerCircle.radius=100);var maxDim=Math.max(FW,FH),x1=radialGradient.innerCircle.centerX/100*FW,y1=radialGradient.innerCircle.centerY/100*FH,r1=radialGradient.innerCircle.radius/100*maxDim,x2=radialGradient.outerCircle.centerX/100*FW,y2=radialGradient.outerCircle.centerY/100*FH,r2=radialGradient.outerCircle.radius/100*maxDim,gradient=CC.context.createRadialGradient(x1,y1,r1,x2,y2,r2);for(var s in radialGradient){var stop=parseFloat(s);!isNaN(stop)&&isFinite(stop)&&gradient.addColorStop(stop,radialGradient[s])}return gradient},createRoundedBorder=function(FW,FH,radius){CC.context.beginPath(),CC.context.moveTo(radius,0),CC.context.lineTo(FW-radius,0),CC.context.quadraticCurveTo(FW,0,FW,radius),CC.context.lineTo(FW,FH-radius),CC.context.quadraticCurveTo(FW,FH,FW-radius,FH),CC.context.lineTo(radius,FH),CC.context.quadraticCurveTo(0,FH,0,FH-radius),CC.context.lineTo(0,radius),CC.context.quadraticCurveTo(0,0,radius,0),CC.context.closePath()};init()},ElementList=function(elements,selection){this.selection=selection,this.length=elements.length;var this_=this,init=function(){implementGlobalMethods()},implementGlobalMethods=function(){for(var i in CC.fn)CC.isFunction(CC.fn[i])&&(this_[i]=CC.fn[i])};this.each=function(action){for(var i in elements)action.call(elements[i]);return this},this.eg=function(index){return elements[index]},this.asArray=function(){return elements.slice(0)},this.inherit=function(classesStr,opts){return this.each(function(){this.inherit(classesStr,opts)}),this},this.sort=function(prop,invert){return elements=CC.sort(elements,prop,invert),this},this.search=function(atrs){var result=[];return this.each(function(){var thisSearch=this.matches(atrs);thisSearch&&result.push(this)}),new ElementList(result,selection+"\n"+JSON.parse(atrs)+"\n\n")},this.merge=function(obj){return this.each(function(){this.merge(obj)}),this},this.remove=function(){this.each(function(){this.remove()})},this.removeClass=function(classe){this.each(function(){this.removeClass(classe)})},this.bind=function(eventsStr,action){var listOfEvents=[];return this.each(function(){listOfEvents.push(this.bind(eventsStr,action))}),{unbind:function(){for(var i in listOfEvents)listOfEvents[i].unbind()}}},this.unbind=function(eventsStr,action){return this.each(function(){this.unbind(eventsStr,action)}),this},this.trigger=function(){var args=arguments;return this.each(function(){this.trigger.apply(this,args)}),this},this.became=function(){var args=arguments,listOfEvents=[];return this.each(function(){listOfEvents.push(this.became.apply(this,args))}),{unbind:function(){for(var i in listOfEvents)listOfEvents[i].unbind()}}},this.while=function(){var args=arguments,listOfEvents=[];return this.each(function(){listOfEvents.push(this.while.apply(this,args))}),{unbind:function(){for(var i in listOfEvents)listOfEvents[i].unbind()}}},this.onClick=function(){var args=arguments,listOfEvents=[];return this.each(function(){listOfEvents.push(this.onClick.apply(this,args))}),{unbind:function(){for(var i in listOfEvents)listOfEvents[i].unbind()}}},this.hideAllLayers=function(){this.each(function(){this.hideAllLayers()})},this.toggleLayers=function(toHide,toShow){this.each(function(){this.toggleLayers(toHide,toShow)})},init()};return CC});